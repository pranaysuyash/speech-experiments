# Resource Management Configuration for Model Lab
# This file defines resource limits and management policies for production deployment

[resources]
# Maximum number of models to keep in memory cache
max_cache_size = 3

# Maximum memory to use for model caching (in MB)
max_cache_memory_mb = 4096

# Memory headroom to maintain (percentage of total available memory)
memory_headroom_percent = 20

# Minimum free disk space required (in GB)
min_disk_space_gb = 10

[model_loading]
# Timeout for model loading (in seconds)
model_load_timeout = 300

# Number of retries for failed model loads
model_load_retries = 3

# Delay between model load retries (in seconds)
retry_delay = 5

[cache_management]
# Cache eviction policy: lru, fifo, or priority
eviction_policy = "lru"

# Time to live for cached models (in seconds, 0 = no ttl)
model_ttl_seconds = 0

# Percentage of cache to free when reaching memory limits
eviction_percentage = 30

[monitoring]
# Enable metrics collection
enable_metrics = true

# Metrics endpoint path
metrics_path = "/metrics"

# Metric collection interval (in seconds)
collection_interval = 15

# Enable detailed tracing
enable_tracing = false

# Tracing endpoint
tracing_endpoint = "http://jaeger:4317"

[security]
# Rate limit requests per minute per IP
rate_limit_requests = 60

# Maximum file upload size (in MB)
max_upload_size_mb = 50

# Allowed file extensions for audio uploads
allowed_extensions = [".wav", ".mp3", ".flac", ".m4a", ".aac"]

[performance]
# Number of worker processes (0 = auto-detect)
worker_processes = 0

# Worker threads per process
worker_threads = 1

# Connection pool size
connection_pool_size = 100

# Maximum concurrent requests
max_concurrent_requests = 50

[logging]
# Log level: debug, info, warning, error
log_level = "info"

# Log format: json or text
log_format = "json"

# Enable access logging
enable_access_log = true

# Log rotation settings
log_rotation_max_size = "100MB"
log_rotation_backup_count = 5

[health]
# Health check interval (in seconds)
health_check_interval = 30

# Number of consecutive failures before marking unhealthy
failure_threshold = 3

# Timeout for individual health checks (in seconds)
check_timeout = 10

[alerts]
# Enable alerting
enable_alerts = true

# Alert for high error rate (% of requests)
error_rate_threshold = 5.0

# Alert for high response time (in seconds)
response_time_threshold = 5.0

# Alert for memory usage (% of limit)
memory_usage_threshold = 80.0

# Alert for disk space (GB remaining)
disk_space_threshold = 5.0